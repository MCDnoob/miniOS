# 堆与栈

## 栈

数据结构，先进后出。

- 栈是一块内存区域；
- 栈顶指针在`ss:esp`寄存器中，栈底是高地址，栈顶是低地址，向下生长。

- `push` 入栈
- `pop` 出栈
- `pusha` 将8个基础寄存器的值压入栈中
- `popa` 将7个基础寄存器弹出，与`popa`相对，但是会忽略`esp`寄存器

## 函数

- `call` 将`call`返回的下一条指令压入栈中
- `ret` 将栈顶弹出到`eip`
- `call` 和 `ret`无关

测试代码
```s
[bits 32]

extern exit

test:
    push $; 当前地址压入栈，在调用ret会直接返回到当前位置，造成死循环
    ret

global main
main:
    ;push 5
    ;push eax

    ;pop ebx
    ;pop ecx

    ;pusha

    ;popa

    call test

    push 0          ; exit code 0
    call exit
```